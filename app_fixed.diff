--- app.py
+++ app.py
@@ -3,6 +3,10 @@
 
 import streamlit as st
 st.set_page_config(
+
+# === [BOOTSTRAP] session keys (must be first) ===
+if "messages" not in st.session_state: st.session_state.messages = []
+if "_last_user_nonce" not in st.session_state: st.session_state["_last_user_nonce"] = None
     page_title="법제처 법무 상담사",
     page_icon="⚖️",
     layout="wide",
@@ -2017,20 +2021,6 @@
     render_bottom_uploader()      # 하단 고정 업로더만
 
 # === PATCH C: 대화 시작 후 하단 업로더 =========================================
-def render_bottom_uploader():
-    import streamlit as st
-    holder = st.empty()
-    with holder.container():
-        st.markdown('<div class="bottom-uploader">', unsafe_allow_html=True)
-        st.file_uploader(
-            "Drag and drop files here",
-            type=["pdf", "docx", "txt"],
-            accept_multiple_files=True,
-            key="bottom_files",
-            help="대화 중에는 업로드 박스가 하단에 고정됩니다.",
-        )
-        st.markdown("</div>", unsafe_allow_html=True)
-
 with st.container():
     for i, m in enumerate(st.session_state.messages):
         role = m.get("role")
@@ -2251,14 +2241,3 @@
 </style>
 """, unsafe_allow_html=True)
 
-# === PATCH D: 본문 흐름 제어 ====================================================
-inject_sticky_layout_css("wide")  # 상단 어딘가 한 번만 호출
-
-# 대화 상태 파악
-_has_msgs = bool(st.session_state.get("messages"))
-_has_pending = bool(st.session_state.get("_pending_user_q"))
-chat_started = _has_msgs or _has_pending  # 한 번이라도 입력되면 True
-
-if not chat_started:
-    # 1) 대화 전 — 중앙 고정 화면
-    render_pre_chat_center()
